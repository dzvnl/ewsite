<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>canvas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">

<style>
    /* --- RESET & BASIC SETUP --- */
    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; padding: 0; }
    
    body {
        font-family: 'VT323', monospace;
        color: #cccccc;
        background-color: #000000; 
        background-image: url('IMG_4928.jpeg'); /* Default, JS will update */
        background-size: cover;
        background-attachment: fixed;
        background-position: center;
        overflow-y: scroll;
    }

    /* --- THE WRAPPER (800px Fixed Width like 2007) --- */
    #site-wrapper {
        width: 900px;
        margin: 0 auto;
        background-color: #000;
        border-left: 1px solid #333;
        border-right: 1px solid #333;
        min-height: 100vh;
        position: relative;
        box-shadow: 0 0 50px #000;
    }

    /* --- TOP TINY BAR --- */
    #top-ticker {
        height: 20px;
        background: #000;
        text-align: right;
        padding-right: 10px;
        font-size: 14px;
        color: #999;
        border-bottom: 1px solid #333;
    }
    #top-ticker a { text-decoration: none; color: #999; margin-left: 10px; }
    #top-ticker a:hover { color: #fff; }

    /* --- HEADER --- */
    #header {
        height: 80px;
        background: linear-gradient(to bottom, #3f0000, #000);
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 20px;
        position: relative;
    }
    .logo-text { font-size: 32px; color: #fff; text-transform: uppercase; letter-spacing: 2px; }
    .logo-text span { color: #b91c1c; } /* Red accent */
    
    /* Center Badge (The Bat Logo Replacement) */
    .center-badge {
        position: absolute;
        left: 50%;
        top: 10px;
        transform: translateX(-50%);
        width: 80px;
        height: 80px;
        background: #000;
        border: 2px solid #b91c1c;
        border-radius: 50%;
        z-index: 10;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #b91c1c;
        font-size: 24px;
        box-shadow: 0 0 10px #b91c1c;
    }

    /* --- NAVIGATION BAR --- */
    #nav-bar {
        height: 30px;
        background: #000;
        border-top: 1px solid #333;
        border-bottom: 1px solid #333;
        display: flex;
        justify-content: center; /* Centered like image */
        align-items: center;
        gap: 30px;
        position: relative;
        z-index: 50; /* Above Hero */
    }
    .nav-link {
        color: #fff;
        text-transform: uppercase;
        text-decoration: none;
        font-size: 18px;
        cursor: pointer;
    }
    .nav-link:hover { color: #b91c1c; }

    /* --- RADIO DROPDOWN --- */
    .dropdown { position: relative; display: inline-block; }
    .dropdown-content {
        display: none;
        position: absolute;
        top: 25px;
        left: 50%;
        transform: translateX(-50%);
        background-color: #111;
        min-width: 250px;
        border: 2px solid #fff;
        padding: 10px;
        z-index: 100;
        text-align: center;
    }
    .dropdown:hover .dropdown-content { display: block; }

    /* Player Controls inside Dropdown */
    .p-btn { background: none; border: none; color: #facc15; font-size: 20px; cursor: pointer; margin: 0 5px; }
    .p-btn:hover { color: #fff; }
    #volume-slider { width: 100%; margin-top: 5px; height: 5px; accent-color: #b91c1c; }

    /* --- MAIN CONTENT GRID --- */
    #content-area { padding: 10px; }

    /* The "Hero" Box (Calendar Girls style) */
    #hero-box {
        width: 100%;
        height: 250px;
        border: 2px solid #fff;
        margin-bottom: 10px;
        position: relative;
        background: radial-gradient(circle at 30% 50%, #500000, #000);
        overflow: hidden;
    }
    #hero-circle {
        position: absolute;
        left: -30px;
        top: 20px;
        width: 200px;
        height: 200px;
        border: 4px solid #b47d3e; /* Goldish */
        border-radius: 50%;
        background: rgba(100,0,0,0.5);
        display: flex;
        align-items: center;
        justify-content: center;
        transform: rotate(-10deg);
        box-shadow: 0 0 20px #000;
    }
    .hero-text-area {
        position: absolute;
        right: 40px;
        top: 60px;
        text-align: right;
    }

    /* --- 3 COLUMN BOTTOM GRID --- */
    .grid-container {
        display: grid;
        grid-template-columns: 280px 280px 290px; /* Specific widths to fill 900px approx */
        gap: 10px;
    }
    
    .grid-col { display: flex; flex-direction: column; gap: 10px; }

    /* Common Box Style */
    .content-box {
        border: 2px solid #fff;
        position: relative;
        background: #0d0d0d;
        overflow: hidden;
    }
    .content-box:hover { border-color: #b91c1c; cursor: pointer; }
    
    .box-header {
        position: absolute;
        top: 5px;
        left: 5px;
        background: #fff;
        color: #000;
        padding: 0 5px;
        font-weight: bold;
        font-size: 16px;
        z-index: 5;
    }

    /* Specific Heights matching image */
    .tall-box { height: 300px; } /* Left col */
    .medium-box { height: 180px; } /* Center/Right top */
    .small-box { height: 110px; } /* Center/Right bottom */

    /* Inner Typography */
    .box-inner-text {
        position: absolute;
        bottom: 10px;
        left: 10px;
        z-index: 5;
    }
    .box-big-title { font-size: 28px; color: #fff; line-height: 1; text-shadow: 2px 2px 0 #000; }
    .box-sub { color: #999; font-size: 14px; }
    .btn-action { 
        background: #b91c1c; color: #fff; padding: 2px 6px; 
        font-size: 14px; display: inline-block; margin-top: 5px;
    }

    /* Image Placeholders (Gradients to mimic photos) */
    .bg-band { background: linear-gradient(to bottom, transparent, #000), url('https://placehold.co/280x300/111/333?text=B-LIVE'); background-size: cover; }
    .bg-swim { background: linear-gradient(to bottom, transparent, #000), url('https://placehold.co/280x180/111/333?text=LIST'); background-size: cover; }
    .bg-settings { background: linear-gradient(to bottom, transparent, #000), url('https://placehold.co/290x180/111/333?text=SETTINGS'); background-size: cover; }
    
    /* MP3 Box Specifics */
    .mp3-box { background: #000; border: 2px solid #fff; height: 110px; padding: 10px; display: flex; align-items: center; }
    #now-playing-cover { width: 80px; height: 80px; border: 1px solid #555; margin-right: 10px; }

    /* Alert Animation */
    .alert-mode { color: #ef4444; text-shadow: 0 0 10px #ef4444; animation: pulse 1.5s infinite; }
    @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }

</style>
</head>
<body>

<div id="site-wrapper">

    <div id="top-ticker">
        <span id="welcome-message">Welcome, ?</span>
        <a href="account.html">(MY ACCOUNT)</a>
        <a href="#">CONTACT US</a>
    </div>

    <div id="header">
        <div class="logo-text">EWS <span>LIVE</span></div>
        <div class="center-badge">
            <img src="https://placehold.co/60x60/000000/b91c1c?text=BAT&font=vt323" style="border-radius:50%">
        </div>
        <div class="logo-text" style="font-size:18px; color: #666;">THE GIRLS | GALLERY</div>
    </div>

    <div id="nav-bar">
        <a href="index.html" class="nav-link">home</a>
        <a href="list.html" class="nav-link">list</a>
        <a href="chat.html" class="nav-link">chat</a>
        
        <div class="dropdown">
            <span class="nav-link" style="color: #facc15;">RADIO â–¼</span>
            <div class="dropdown-content">
                <div style="color: #fff; margin-bottom: 5px;">PLAYER CONTROLS</div>
                <button id="rewind-btn" class="p-btn">[&lt;&lt;]</button>
                <button id="play-pause-btn" class="p-btn">[&gt;]</button>
                <button id="skip-btn" class="p-btn">[&gt;&gt;]</button>
                <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="1">
            </div>
        </div>

        <a href="settings.html" class="nav-link">SETTINGS</a>
    </div>

    <div id="content-area">

        <div id="hero-box">
            <div id="hero-circle">
                <div style="color: #facc15; font-size: 30px; text-align: center; line-height: 0.9;">
                    EWS<br><span style="font-size: 50px; color: #fff;">Girls</span>
                </div>
            </div>
            
            <div class="hero-text-area">
                <div style="font-size: 24px; color: #fff;">Check out the new</div>
                <div id="splash-text" style="font-size: 48px; color: #fff; font-weight: bold;">Loading...</div>
                <div class="btn-action" style="float: right;">ENTER IN &gt;</div>
            </div>
        </div>

        <div class="grid-container">
            
            <div class="grid-col">
                <a href="chat.html" class="content-box tall-box bg-band">
                    <div class="box-header">B-LIVE</div>
                    <div class="box-inner-text">
                        <div class="box-big-title">VEGAS REWIND!</div>
                        <div class="box-sub">Join the Discussion</div>
                        <div class="btn-action">LISTEN IN!</div>
                    </div>
                </a>
            </div>

            <div class="grid-col">
                <a href="list.html" class="content-box medium-box bg-swim">
                    <div class="box-header">Swim Upstream</div>
                    <div class="box-inner-text">
                        <div class="box-big-title">THE LIST?</div>
                        <div class="box-sub">Are you in?</div>
                        <div class="btn-action">VIEW LIST</div>
                    </div>
                </a>
                
                <div class="content-box small-box mp3-box">
                    <img id="now-playing-cover" src="" alt="cover">
                    <div style="flex:1; overflow: hidden;">
                        <div style="color: #b91c1c; font-weight: bold; margin-bottom: 2px;">NOW PLAYING:</div>
                        <div id="player-title" style="color: #fff; font-size: 18px; white-space: nowrap;">...</div>
                        <div id="player-artist" style="color: #666; font-size: 14px;">Loading...</div>
                        <div style="font-size: 12px; color: #facc15; margin-top: 5px;">FREE MP3 DOWNLOAD!</div>
                    </div>
                </div>
            </div>

            <div class="grid-col">
                <a href="settings.html" class="content-box medium-box bg-settings">
                    <div class="box-header">CHALLENGE</div>
                    <div class="box-inner-text">
                        <div class="box-big-title">SETTINGS</div>
                        <div class="box-sub">Customize your exp.</div>
                        <div class="btn-action">ENTER NOW</div>
                    </div>
                </a>

                <div class="content-box small-box" style="background: #fff; border: 2px solid #ccc;">
                    <div style="padding: 10px; color: #000; text-align: center;">
                        <div style="font-weight: bold; font-size: 20px;">VERSION 2.0</div>
                        <img src="https://placehold.co/100x50/333/fff?text=iPOD" style="margin: 5px auto; display: block;">
                        <a href="chat.html" style="background: #b91c1c; color: #fff; padding: 2px 5px; text-decoration: none;">DOWNLOAD IT!</a>
                    </div>
                </div>
            </div>

        </div> </div> <div style="padding: 10px; color: #444; font-size: 12px; text-align: center;">
        EWS Live 2025. Check the DOWNLOAD Section.
    </div>

</div>

<audio id="audio-player"></audio>
<div id="player-info-container" style="display:none;"></div>
<img id="player-cover-art" style="display:none;" src=""> 

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyAlUyqTb9onQ0PyOxLfZkDddeSnYdB2PlQ",
        authDomain: "ewsitechat.firebaseapp.com",
        databaseURL: "https://ewsitechat-default-rtdb.firebaseio.com",
        projectId: "ewsitechat",
        storageBucket: "ewsitechat.firebasestorage.app",
        messagingSenderId: "282495574514",
        appId: "1:282495574514:web:e2781da630d93fc1ce8b6b"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const splashEl = document.getElementById('splash-text');
    const randomSplashes = [
        "blacked out like an lv sandal", "son", "bbq chicken alert", 
        "trick or treat.. smell my.. donuts..", "100 perkaholic or pounded by a margwa",
        "considering a page", "long live futtbucker", "six seven", "oh brother..",
        "are you even an ew student?", "i bet ur failing", "get the bawlls!!",
        "six one", "add jiggletip on clash", "new stuff soon",
        "WE yes WE are brainless and failing", "updates soon.. -nl", "no super seniors", "considering a chat board"
    ];
    const announcementRef = ref(db, 'admin/announcement');

    onValue(announcementRef, (snapshot) => {
        const data = snapshot.val();
        if (data && data.text) {
            splashEl.innerText =` ${data.text.toLowerCase()} `;
            splashEl.classList.add('alert-mode');
        } else {
            splashEl.classList.remove('alert-mode');
            if (splashEl.innerText.includes("ALERT") || splashEl.innerText === "Loading...") {
                splashEl.innerText = randomSplashes[Math.floor(Math.random() * randomSplashes.length)];
            }
        }
    });
</script>

<script>
    const baseURL = "https://ewsmusic1.netlify.app/"; 
    const playlist = [
        { title: "Xtal", artist: "Aphex Twin", src: baseURL + "xtal.mp3", cover: baseURL + "aphex.jpg" },
        { title: "I Don't Wanna Be Me", artist: "Type O Negative", src: baseURL + "idontwannabeme.mp3", cover: baseURL + "ton.jpg" },
        { title: "Life Is Killing Me", artist: "Type O Negative", src: baseURL + "lifeiskilling.mp3", cover: baseURL + "ton.jpg" },
        { title: "Exit Music (For a Film)", artist: "Radiohead", src: baseURL + "exitmusic.mp3", cover: baseURL + "radiohead.jpg" },
        { title: "Alternative Outro", artist: "LUCKI", src: baseURL + "alternativeoutro.mp3", cover: baseURL + "lucki.jpg" },
        { title: "Bite My Lip", artist: "fakemink", src: baseURL + "bitemylip.mp3", cover: baseURL + "fakemink.jpg" },
        { title: "Ambilux", artist: "fakemink", src: baseURL + "ambilux.mp3", cover: baseURL + "fakemink3.jpg" },
        { title: "I'm Like Why", artist: "xaviersobased", src: baseURL + "imlikewhy.mp3", cover: baseURL + "xav.jpg" },
        { title: "Love Hate", artist: "xaviersobased", src: baseURL + "lovehate.mp3", cover: baseURL + "xav2.jpg" },
        { title: "Foamposite Interlude", artist: "smokedope2016", src: baseURL + "foamposite.mp3", cover: baseURL + "smokedope2016.jpg" },
        { title: "Abysmal Depths Are Flooded", artist: "Xasthur", src: baseURL + "abysmaldepthsareflooded.mp3", cover: baseURL + "xasthur.jpg" },
        { title: "Diamonds", artist: "Chris Travis", src: baseURL + "diamonds.mp3", cover: baseURL + "christravis.jpg" },
        { title: "Black Magic", artist: "Ethel Wulf", src: baseURL + "blackmagic.mp3", cover: baseURL + "ethel.jpg" },
        { title: "4 Raws", artist: "EsDeeKid", src: baseURL + "4raws.mp3", cover: baseURL + "esdee.jpg" },
        { title: "Fever", artist: "fakemink/buckshot", src: baseURL + "fever.mp3", cover: baseURL + "buckshot.jpg" },
        { title: "Stalks", artist: "Ghost Mountain", src: baseURL + "stalks.mp3", cover: baseURL + "ghostmountain.jpg" },
        { title: "MIA", artist: "feng", src: baseURL + "mia.mp3", cover: baseURL + "feng.jpg" },
        { title: "head in the ceiling fan", artist: "Title Fight", src: baseURL + "titlefight.mp3", cover: baseURL + "title-fih.jpg" },
        { title: "Turn Me Loose", artist: "limpbizkit/eminem", src: baseURL + "turnmeloose.mp3", cover: baseURL + "limp.jpg" },
        { title: "black beetles", artist: "esdeekid", src: baseURL + "bbr.mp3", cover: baseURL + "esdee2.jpg" },
        { title: "apathy", artist: "esdeekid", src: baseURL + "apathy.mp3", cover: baseURL + "esdee3.jpg" },
        { title: "bring it back", artist: "chris travis", src: baseURL + "bib.mp3", cover: baseURL + "chris2.jpg" },
        { title: "die til you live", artist: "fakemink", src: baseURL + "dtyl.mp3", cover: baseURL + "fakemink5.jpg" },
        { title: "worthit", artist: "xaviersobased", src: baseURL + "worthit.mp3", cover: baseURL + "81853ABB-FB87-4A20-9303-9624B777245B.jpeg" },
        { title: "in da party", artist: "smokedope2016", src: baseURL + "indaparty.mp3", cover: baseURL + "smokedope4.jpg" },
        { title: "say it aint dro", artist: "smokedope2016", src: baseURL + "dro.mp3", cover: baseURL + "smokedope3.jpg" },
        { title: "blunts on my mind", artist: "ethel wulf", src: baseURL + "bluntsomm.mp3", cover: baseURL + "ethel2.jpg" },
        { title: "luper", artist: "earl sweatshirt", src: baseURL + "luper.mp3", cover: baseURL + "earl.jpg" },
        { title: "frat", artist: "smokedope2016", src: baseURL + "frat.mp3", cover: baseURL + "smokedope2.jpg" },
        { title: "hit the home", artist: "the hand of peace", src: baseURL + "clock.mp3", cover: baseURL + "handofpeace.jpg" },
        { title: "blow me", artist: "fakemink", src: baseURL + "blowme.mp3", cover: baseURL + "fakeminkk.jpg" },
        { title: "minerva", artist: "deftones", src: baseURL + "minerva.mp3", cover: baseURL + "deftones.jpg" },
        { title: "hold on", artist: "limpbizkit", src: baseURL + "holdon.mp3", cover: baseURL + "limpbizkit.jpg" },
        { title: "my way", artist: "limpbizkit", src: baseURL + "myway.mp3", cover: baseURL + "limpbizkit.jpg" },
        { title: "new update soon", artist: "-nl", src: baseURL + "xtal.mp3", cover: baseURL + "aphextwin.jpg" }
    ];

    document.addEventListener('DOMContentLoaded', () => {
        const playerTitleEl = document.getElementById('player-title');
        const playerArtistEl = document.getElementById('player-artist');
        const nowPlayingCover = document.getElementById('now-playing-cover');

        try {
            // --- BACKGROUND LOGIC ---
            const specialBg = '81853ABB-FB87-4A20-9303-9624B777245B.jpeg';
            const normalBackgrounds = ['IMG_4928.jpeg', 'IMG_4946.jpeg', 'IMG_4944.jpeg', 'IMG_4943.jpeg', 'IMG_5262.jpeg', 'IMG_5263.jpeg', 'IMG_5264.jpeg', 'IMG_4945.jpeg'];
            const chance = Math.floor(Math.random() * 100); 
            let chosenBg = (chance === 0) ? specialBg : normalBackgrounds[Math.floor(Math.random() * normalBackgrounds.length)];
            document.body.style.backgroundImage = `url('${chosenBg}')`;

            // --- USER UI ---
            const welcomeMessage = document.getElementById('welcome-message');
            function updateUI() {
                let username = localStorage.getItem('username');
                welcomeMessage.textContent = username ? `Welcome, ${username}` : 'Welcome, ?';
            }
            updateUI();

            // --- MUSIC PLAYER LOGIC ---
            const audioPlayer = document.getElementById('audio-player');
            const playPauseBtn = document.getElementById('play-pause-btn');
            const rewindBtn = document.getElementById('rewind-btn');
            const skipBtn = document.getElementById('skip-btn');
            const volumeSlider = document.getElementById('volume-slider');
            const placeholderCover = "https://placehold.co/80x80/000000/333333?text=...&font=vt323";

            let currentSongIndex = 0;
            let isPlaying = false;

            const secretSong = {
                title: "hey, big guy said im an easter egg",
                artist: "i heard, if u put /secret at the end of the link",
                src: "clock.mp3",
                cover: "handofpeace.jpg"
            };

            function loadSong(songIndex) {
                const song = (songIndex === -1) ? secretSong : playlist[songIndex];
                if (!song || !song.src || !song.cover) { skipSong(true); return; }

                audioPlayer.src = song.src; 
                playerTitleEl.textContent = song.title;
                playerArtistEl.textContent = song.artist;
                nowPlayingCover.src = song.cover;
                playPauseBtn.textContent = '[>]';
                isPlaying = false;
            }

            function playSong() {
                if (!audioPlayer.src) { return; }
                audioPlayer.volume = volumeSlider.value; 
                const playPromise = audioPlayer.play();
                if (playPromise !== undefined) {
                    playPromise.then(() => {
                        playPauseBtn.textContent = '[||]';
                        isPlaying = true;
                    }).catch(console.warn);
                }
            }

            function pauseSong() {
                audioPlayer.pause();
                playPauseBtn.textContent = '[>]';
                isPlaying = false;
            }

            function togglePlayPause() {
                if (isPlaying) { pauseSong(); } else { playSong(); }
            }

            function skipSong(skipOnly = false) {
                let nextSongIndex = Math.floor(Math.random() * playlist.length);
                if (nextSongIndex === currentSongIndex && playlist.length > 1) {
                    nextSongIndex = (nextSongIndex + 1) % playlist.length; 
                }
                currentSongIndex = nextSongIndex;
                loadSong(currentSongIndex);
                if (audioPlayer.src && !skipOnly) { playSong(); }
            }

            function rewindSong() {
                currentSongIndex = (currentSongIndex - 1 + playlist.length) % playlist.length;
                loadSong(currentSongIndex);
                if (audioPlayer.src) { playSong(); }
            }

            // --- STORAGE ---
            window.addEventListener('beforeunload', () => {
                if (audioPlayer.currentTime > 0) {
                    const musicState = {
                        currentSongIndex: currentSongIndex,
                        currentTime: audioPlayer.currentTime,
                        volume: audioPlayer.volume,
                        isPlaying: isPlaying
                    };
                    sessionStorage.setItem('musicPlayerState', JSON.stringify(musicState));
                }
            });

            function loadInitialState() {
                const savedStateJSON = sessionStorage.getItem('musicPlayerState');
                let savedState = null;
                try { savedState = JSON.parse(savedStateJSON); } catch (e) {}

                if (savedState) {
                    currentSongIndex = savedState.currentSongIndex;
                    loadSong(currentSongIndex);
                    volumeSlider.value = savedState.volume || 1;
                    audioPlayer.volume = savedState.volume || 1;
                    audioPlayer.addEventListener('loadedmetadata', () => {
                        audioPlayer.currentTime = savedState.currentTime || 0;
                        if (savedState.isPlaying) { playSong(); }
                    }, { once: true }); 
                } else {
                    currentSongIndex = Math.floor(Math.random() * playlist.length);
                    loadSong(currentSongIndex);
                }
            }

            playPauseBtn.addEventListener('click', togglePlayPause);
            skipBtn.addEventListener('click', () => skipSong(false));
            rewindBtn.addEventListener('click', rewindSong);
            volumeSlider.addEventListener('input', (e) => { audioPlayer.volume = e.target.value; });
            audioPlayer.addEventListener('ended', () => skipSong(false));
            nowPlayingCover.addEventListener('error', () => { nowPlayingCover.src = placeholderCover; });

            loadInitialState();

        } catch (e) {
            console.error(e);
        }
    });
</script>
</body>
</html>
