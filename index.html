<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>canvas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">


<style>
    html, body { height: 100%; scroll-behavior: smooth; }
    body {
        font-family: 'VT323', monospace;
        color: #e5e5e5;
        background-color: #000000; 
        background-image: url('IMG_4928.jpeg'); 
        background-size: cover;
        background-repeat: no-repeat;
        background-attachment: fixed;
        background-position: center;
    }
    .pixel-font {
        font-family: 'VT323', monospace;
        font-smooth: never;
        -webkit-font-smoothing: none;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.4);
    }
    
    /* --- PLAYER CSS --- */
    #music-player-widget {
        position: fixed;
        bottom: 1.5rem; 
        right: 1.5rem;
        z-index: 50;
        width: 320px; 
        height: auto;
        background-color: rgba(0, 0, 0, 0.8);
        border: none;
        padding: 0.75rem;
        display: flex;
        align-items: center;
        border-radius: 4px;
    }
    #player-cover-art {
        width: 64px;
        height: 64px;
        flex-shrink: 0; 
        margin-right: 0.75rem; 
        border: 2px dotted #969696; 
        background-color: #111;
        image-rendering: pixelated;
    }
    #player-main { flex-grow: 1; overflow: hidden; min-width: 0; }
    #player-title {
        color: #ffffff;
        font-size: 1.125rem;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    #player-artist {
        font-size: 0.875rem;
        color: #969696;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        margin-bottom: 4px;
    }
    .player-controls-row { display: flex; align-items: center; gap: 0.25rem; }
    .player-controls-row button {
        color: #facc15;
        font-size: 1.25rem;
        flex-shrink: 0;
        padding: 0 0.25rem;
        background: none;
        border: none;
        cursor: pointer;
    }
    .player-controls-row button:hover { color: #fff; }
    #play-pause-btn { font-size: 1.5rem; line-height: 1; }
    #volume-slider {
        -webkit-appearance: none;
        width: 100%; 
        flex-grow: 1;
        height: 16px; 
        background: transparent;
        margin-left: 0.5rem; 
    }
    #volume-slider::-webkit-slider-runnable-track {
        width: 100%;
        height: 4px;
        background: #333;
        border: 1px solid #969696;
    }
    #volume-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        width: 16px;
        height: 16px;
        background: #facc15; 
        border: 1px solid #000;
        border-radius: 50%;
        margin-top: -7px; 
        cursor: pointer;
    }
</style>
```

</head>
<body>

```
<nav class="fixed left-0 top-1/2 -translate-y-1/2 p-6 sm:p-8 pixel-font z-10">
    <h1 class="text-3xl lg:text-4xl text-gray-300 mb-2" style="color: #bebebe;"></h1>
    <ul class="text-2xl lg:text-3xl space-y-1" style="color: #969696;">
        <li><a href="/secrets" class="hover:text-red-900">home</a></li>
        <li><a href="/list" class="hover:text-red-900">list</a></li>
        <li><a href="/settings" class="hover:text-red-900">settings</a></li>
        <li><a href="https://yodelling-amberly-ewsite-0c6ae866.koyeb.app/" class="hover:text-red-900 active:text-red-900 transition-colors">proxy</a></li>
    </ul>
</nav>

<div class="fixed top-2/3 left-1/2 -translate-x-1/2 -translate-y-1/2 pixel-font text-yellow-400 text-lg lg:text-xl text-center z-10 p-4">
    <p id="splash-text"></p>
</div>

<div class="fixed top-0 right-0 p-4 pixel-font text-yellow-400 text-sm sm:text-base text-right z-10">
<div class="fixed top-0 right-0 p-4 ...">
    <li><a href="javascript:void(0)" onclick="openChat()">2.0</a></li>
    <p id="welcome-message">Welcome, ?</p>
    <a href="#" id="auth-link" class="text-xs hover:text-yellow-400 transition-colors" style="color: #969696;">(sign up / sign in)</a>
</div>

<audio id="audio-player"></audio>
<div id="music-player-widget" class="pixel-font">
    <img id="player-cover-art" src="https://placehold.co/64x64/000000/333333?text=...&font=vt323" alt="Album Cover">
    <div id="player-main">
        <div id="player-info-container" title="...">
            <div id="player-title">...</div>
            <div id="player-artist">Loading...</div>
        </div>
        <div class="player-controls-row">
            <button id="rewind-btn" title="Previous">[&lt;&lt;]</button>
            <button id="play-pause-btn" title="Play/Pause">[&gt;]</button>
            <button id="skip-btn" title="Next (Shuffle)">[&gt;&gt;]</button>
            <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="1" title="Volume">
        </div>
    </div>
</div>

<script>

    const baseURL = "https://ewsmusic1.netlify.app/"; 
    const playlist = [
        { title: "Xtal", artist: "Aphex Twin", src: baseURL + "xtal.mp3", cover: baseURL + "aphex.jpg" },
        { title: "I Don't Wanna Be Me", artist: "Type O Negative", src: baseURL + "idontwannabeme.mp3", cover: baseURL + "ton.jpg" },
        { title: "Life Is Killing Me", artist: "Type O Negative", src: baseURL + "lifeiskilling.mp3", cover: baseURL + "ton.jpg" },
        { title: "Exit Music (For a Film)", artist: "Radiohead", src: baseURL + "exitmusic.mp3", cover: baseURL + "radiohead.jpg" },
        { title: "Alternative Outro", artist: "LUCKI", src: baseURL + "alternativeoutro.mp3", cover: baseURL + "lucki.jpg" },
        { title: "Bite My Lip", artist: "fakemink", src: baseURL + "bitemylip.mp3", cover: baseURL + "fakemink.jpg" },
        { title: "Ambilux", artist: "fakemink", src: baseURL + "ambilux.mp3", cover: baseURL + "fakemink3.jpg" },
        { title: "I'm Like Why", artist: "xaviersobased", src: baseURL + "imlikewhy.mp3", cover: baseURL + "xav.jpg" },
        { title: "Love Hate", artist: "xaviersobased", src: baseURL + "lovehate.mp3", cover: baseURL + "xav2.jpg" },
        { title: "Foamposite Interlude", artist: "smokedope2016", src: baseURL + "foamposite.mp3", cover: baseURL + "smokedope2016.jpg" },
        { title: "Abysmal Depths Are Flooded", artist: "Xasthur", src: baseURL + "abysmaldepthsareflooded.mp3", cover: baseURL + "xasthur.jpg" },
        { title: "Diamonds", artist: "Chris Travis", src: baseURL + "diamonds.mp3", cover: baseURL + "christravis.jpg" },
        { title: "Black Magic", artist: "Ethel Wulf", src: baseURL + "blackmagic.mp3", cover: baseURL + "ethel.jpg" },
        { title: "4 Raws", artist: "EsDeeKid", src: baseURL + "4raws.mp3", cover: baseURL + "esdee.jpg" },
        { title: "Fever", artist: "fakemink/buckshot", src: baseURL + "fever.mp3", cover: baseURL + "buckshot.jpg" },
        { title: "Stalks", artist: "Ghost Mountain", src: baseURL + "stalks.mp3", cover: baseURL + "ghostmountain.jpg" },
        { title: "MIA", artist: "feng", src: baseURL + "mia.mp3", cover: baseURL + "feng.jpg" },
        { title: "head in the ceiling fan", artist: "Title Fight", src: baseURL + "titlefight.mp3", cover: baseURL + "title-fih.jpg" },
        { title: "Turn Me Loose", artist: "limpbizkit/eminem", src: baseURL + "turnmeloose.mp3", cover: baseURL + "limp.jpg" },
        { title: "black beetles", artist: "esdeekid", src: baseURL + "bbr.mp3", cover: baseURL + "esdee2.jpg" },
        { title: "apathy", artist: "esdeekid", src: baseURL + "apathy.mp3", cover: baseURL + "esdee3.jpg" },
        { title: "bring it back", artist: "chris travis", src: baseURL + "bib.mp3", cover: baseURL + "chris2.jpg" },
        { title: "die til you live", artist: "fakemink", src: baseURL + "dtyl.mp3", cover: baseURL + "fakemink5.jpg" },
        { title: "worthit", artist: "xaviersobased", src: baseURL + "worthit.mp3", cover: baseURL + "81853ABB-FB87-4A20-9303-9624B777245B.jpeg" },
        { title: "in da party", artist: "smokedope2016", src: baseURL + "indaparty.mp3", cover: baseURL + "smokedope4.jpg" },
        { title: "say it aint dro", artist: "smokedope2016", src: baseURL + "dro.mp3", cover: baseURL + "smokedope3.jpg" },
        { title: "blunts on my mind", artist: "ethel wulf", src: baseURL + "bluntsomm.mp3", cover: baseURL + "ethel2.jpg" },
        { title: "luper", artist: "earl sweatshirt", src: baseURL + "luper.mp3", cover: baseURL + "earl.jpg" },
        { title: "frat", artist: "smokedope2016", src: baseURL + "frat.mp3", cover: baseURL + "smokedope2.jpg" },
        { title: "hit the home", artist: "the hand of peace", src: baseURL + "clock.mp3", cover: baseURL + "handofpeace.jpg" },
        { title: "blow me", artist: "fakemink", src: baseURL + "blowme.mp3", cover: baseURL + "fakeminkk.jpg" },
        { title: "minerva", artist: "deftones", src: baseURL + "minerva.mp3", cover: baseURL + "deftones.jpg" },
        { title: "hold on", artist: "limpbizkit", src: baseURL + "holdon.mp3", cover: baseURL + "limpbizkit.jpg" },
        { title: "my way", artist: "limpbizkit", src: baseURL + "myway.mp3", cover: baseURL + "limpbizkit.jpg" },
        { title: "new update soon", artist: "-nl", src: baseURL + "xtal.mp3", cover: baseURL + "aphextwin.jpg" }
    ];

    document.addEventListener('DOMContentLoaded', () => {
        const playerTitleEl = document.getElementById('player-title');
        const playerArtistEl = document.getElementById('player-artist');
        
        try {
            // --- BACKGROUND LOGIC (1/100 Chance) ---
            const specialBg = '81853ABB-FB87-4A20-9303-9624B777245B.jpeg';
            const normalBackgrounds = ['IMG_4928.jpeg', 'IMG_4946.jpeg', 'IMG_4944.jpeg', 'IMG_4943.jpeg', 'IMG_5262.jpeg', 'IMG_5263.jpeg', 'IMG_5264.jpeg', 'IMG_4945.jpeg'];
            const chance = Math.floor(Math.random() * 100); 
            let chosenBg = (chance === 0) ? specialBg : normalBackgrounds[Math.floor(Math.random() * normalBackgrounds.length)];
            document.body.style.backgroundImage = `url('${chosenBg}')`;
            
            // --- SPLASH TEXT & AUTH ---
            const splashElement = document.getElementById('splash-text');
            if (splashElement) {
                const splashOptions = [
                    "blacked out like an lv sandal", "son", "bbq chicken alert", 
                    "trick or treat.. smell my.. donuts..", "100 perkaholic or pounded by a margwa",
                    "considering a page", "long live futtbucker", "six seven", "oh brother..",
                    "are you even an ew student?", "i bet ur failing", "get the bawlls!!",
                    "six one", "add jiggletip on clash", "new stuff soon",
                    "WE yes WE are brainless and failing", "updates soon.. -nl", "no super seniors", "considering a chat board"
                ];
                splashElement.textContent = splashOptions[Math.floor(Math.random() * splashOptions.length)];
            }
            
            const welcomeMessage = document.getElementById('welcome-message');
            const authLink = document.getElementById('auth-link');
            
            function updateUI() {
                let username = localStorage.getItem('username');
                if (username) {
                    welcomeMessage.textContent = `Welcome, ${username}`;
                    authLink.textContent = '(sign out)';
                    authLink.href = '#';
                    authLink.onclick = signOut;
                } else {
                    welcomeMessage.textContent = 'Welcome, ?';
                    authLink.textContent = '(sign up / sign in)';
                    authLink.href = 'login.html';
                    authLink.onclick = null;
                }
            }
            
            function signOut(e) {
                e.preventDefault();
                if (confirm('Are you sure you want to sign out?')) {
                    localStorage.removeItem('username');
                    updateUI();
                }
            }
            
            updateUI();
            
            // --- MUSIC PLAYER LOGIC ---
            const audioPlayer = document.getElementById('audio-player');
            const playPauseBtn = document.getElementById('play-pause-btn');
            const rewindBtn = document.getElementById('rewind-btn');
            const skipBtn = document.getElementById('skip-btn');
            const playerInfoContainer = document.getElementById('player-info-container');
            const volumeSlider = document.getElementById('volume-slider');
            const playerCoverArt = document.getElementById('player-cover-art');
            const placeholderCover = "https://placehold.co/64x64/000000/333333?text=...&font=vt323";
            
            let currentSongIndex = 0;
            let isPlaying = false;

            const secretSong = {
                title: "hey, big guy said im an easter egg",
                artist: "i heard, if u put /secret at the end of the link",
                src: "clock.mp3",
                cover: "handofpeace.jpg"
            };

            function loadSong(songIndex) {
                const song = (songIndex === -1) ? secretSong : playlist[songIndex];
                if (!song || !song.src || !song.cover) {
                    console.error("Invalid song data at index:", songIndex);
                    skipSong(true); 
                    return;
                }
                
                audioPlayer.src = song.src; 
                playerInfoContainer.title = `${song.title} - ${song.artist}`; 
                playerTitleEl.textContent = song.title;
                playerArtistEl.textContent = song.artist;
                playerCoverArt.src = song.cover;
                playPauseBtn.textContent = '[>]';
                isPlaying = false;
            }

            function playSong() {
                if (!audioPlayer.src) { return; }
                audioPlayer.volume = volumeSlider.value; 
                
                const playPromise = audioPlayer.play();
                if (playPromise !== undefined) {
                    playPromise.then(() => {
                        playPauseBtn.textContent = '[||]';
                        isPlaying = true;
                    }).catch(error => {
                        console.warn("Auto-play failed:", error.name);
                        playerTitleEl.textContent = "Click Play";
                        playerArtistEl.textContent = "to start music";
                        isPlaying = false;
                    });
                }
            }

            function pauseSong() {
                audioPlayer.pause();
                playPauseBtn.textContent = '[>]';
                isPlaying = false;
            }

            function togglePlayPause() {
                if (isPlaying) { pauseSong(); } else { playSong(); }
            }

            function skipSong(skipOnly = false) {
                let nextSongIndex = Math.floor(Math.random() * playlist.length);
                if (nextSongIndex === currentSongIndex && playlist.length > 1) {
                    nextSongIndex = (nextSongIndex + 1) % playlist.length; 
                }
                currentSongIndex = nextSongIndex;
                loadSong(currentSongIndex);
                if (audioPlayer.src && !skipOnly) { playSong(); }
            }

            function rewindSong() {
                currentSongIndex = (currentSongIndex - 1 + playlist.length) % playlist.length;
                loadSong(currentSongIndex);
                if (audioPlayer.src) { playSong(); }
            }
            
            // --- STORAGE SAVE/LOAD ---
            window.addEventListener('beforeunload', () => {
                if (audioPlayer.currentTime > 0) {
                    const musicState = {
                        currentSongIndex: currentSongIndex,
                        currentTime: audioPlayer.currentTime,
                        volume: audioPlayer.volume,
                        isPlaying: isPlaying
                    };
                    sessionStorage.setItem('musicPlayerState', JSON.stringify(musicState));
                } else {
                    sessionStorage.removeItem('musicPlayerState');
                }
            });
            
            function loadInitialState() {
                const savedStateJSON = sessionStorage.getItem('musicPlayerState');
                let savedState = null;
                if (savedStateJSON) {
                    try { savedState = JSON.parse(savedStateJSON); } 
                    catch (e) { sessionStorage.removeItem('musicPlayerState'); }
                }

                if (savedState) {
                    currentSongIndex = savedState.currentSongIndex;
                    loadSong(currentSongIndex);
                    volumeSlider.value = savedState.volume || 1;
                    audioPlayer.volume = savedState.volume || 1;
                    audioPlayer.addEventListener('loadedmetadata', () => {
                        audioPlayer.currentTime = savedState.currentTime || 0;
                        if (savedState.isPlaying) { playSong(); }
                    }, { once: true }); 
                    
                } else {
                    const rareSongChance = Math.floor(Math.random() * 50);
                    currentSongIndex = (rareSongChance === 0) ? -1 : Math.floor(Math.random() * playlist.length);
                    loadSong(currentSongIndex);
                    audioPlayer.volume = volumeSlider.value;
                }
            }
            
            playPauseBtn.addEventListener('click', togglePlayPause);
            skipBtn.addEventListener('click', () => skipSong(false));
            rewindBtn.addEventListener('click', rewindSong);
            volumeSlider.addEventListener('input', (e) => { audioPlayer.volume = e.target.value; });
            audioPlayer.addEventListener('ended', () => skipSong(false));
            audioPlayer.addEventListener('error', (e) => {
                playerTitleEl.textContent = `Load Error (404)`;
                playerArtistEl.textContent = `Check file name`;
            });
            playerCoverArt.addEventListener('error', () => {
                playerCoverArt.src = placeholderCover;
            });

            loadInitialState();
            
        } catch (e) {
            console.error("Global script error:", e);
            playerTitleEl.textContent = "Code Error";
            playerArtistEl.textContent = e.message;
        }
    });
</script>
```
<script type="module" src="chat.js"></script>

</body>
</html>