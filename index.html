<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>canvas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@700&display=swap" rel="stylesheet">

<style>
    /* --- RESET --- */
    body {
        margin: 0; padding: 0;
        background-color: #000;
        color: #b0b0b0;
        font-family: 'Verdana', sans-serif;
        font-size: 11px;
        height: 100vh;
        overflow-x: hidden;
    }
    a { text-decoration: none; color: inherit; }

    /* --- LAYOUT CONTAINER --- */
    .layout-grid {
        display: grid;
        grid-template-columns: 180px 1fr; /* Left Menu | Right Content */
        grid-template-rows: 100px auto;   /* Top Header | Main Content */
        width: 900px;
        margin: 20px auto;
        min-height: 600px;
        position: relative;
    }

    /* --- 1. SKULL / LOGO AREA (Top Left) --- */
    .logo-zone {
        grid-column: 1 / 2;
        grid-row: 1 / 2;
        position: relative;
        z-index: 10;
    }
    /* ADD YOUR IMAGE HERE */
    .skull-img {
        position: absolute;
        top: 0; left: 0;
        width: 200px; /* Adjust size */
        height: auto;
        opacity: 0.9;
        /* If you don't have an image yet, this grey circle shows where it goes */
        background: radial-gradient(circle, #333 0%, #000 70%); 
        border-radius: 50%;
        height: 180px;
    }

    /* --- 2. HEADER BAR (Top Right) --- */
    .header-bar {
        grid-column: 2 / 3;
        grid-row: 1 / 2;
        border-bottom: 2px solid #333;
        display: flex;
        align-items: center;
        padding-left: 20px;
        background: linear-gradient(to right, #111, #000);
    }
    .header-title {
        font-family: 'Roboto Condensed', sans-serif;
        font-size: 24px;
        color: #444;
        text-transform: uppercase;
        letter-spacing: 2px;
    }

    /* --- 3. LEFT MENU (The "Dropdown" Look) --- */
    .nav-column {
        grid-column: 1 / 2;
        grid-row: 2 / 3;
        padding-top: 40px;
        display: flex;
        flex-direction: column;
        align-items: flex-end; /* Align to the right side of the column */
        padding-right: 15px;
        border-right: 1px solid #222; /* Faint line separating menu */
    }

    /* The Menu Buttons */
    .menu-item {
        display: block;
        width: 100px;
        background-color: #1a1a1a;
        border: 1px solid #444;
        margin-bottom: 4px;
        padding: 6px 10px;
        font-family: 'VT323', monospace;
        font-size: 16px;
        color: #888;
        text-align: center;
        text-transform: uppercase;
        box-shadow: 2px 2px 0px #000;
        transition: all 0.2s;
        cursor: pointer;
    }
    .menu-item:hover {
        background-color: #333;
        color: #facc15; /* Your Yellow Accent */
        border-color: #666;
        transform: translateX(5px); /* Pops out slightly */
    }

    /* --- 4. MAIN CONTENT AREA --- */
    .content-area {
        grid-column: 2 / 3;
        grid-row: 2 / 3;
        padding: 30px;
        background-color: #050505;
        border-left: 4px solid #111;
        min-height: 500px;
    }

    /* Your Splash Text Styles */
    .splash-container {
        font-family: 'VT323', monospace;
        font-size: 1.5rem;
        color: #facc15; /* Yellow */
        margin-bottom: 20px;
        border-bottom: 1px dashed #333;
        padding-bottom: 10px;
    }
    .alert-mode {
        color: #ef4444 !important; /* Red */
        text-shadow: 0 0 10px #ef4444;
        animation: pulse 1.5s infinite;
    }
    @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }

    /* Welcome User Text */
    .user-status {
        font-family: 'VT323', monospace;
        color: #666;
        font-size: 14px;
        text-align: right;
        margin-bottom: 20px;
    }

    /* --- MUSIC PLAYER (Fixed Bottom Right) --- */
    #music-player-widget {
        position: fixed;
        bottom: 20px; right: 20px; z-index: 50;
        width: 300px;
        background-color: #0a0a0a;
        border: 1px solid #333;
        padding: 10px;
        display: flex; align-items: center;
        font-family: 'VT323', monospace;
    }
    #player-cover-art {
        width: 50px; height: 50px; 
        margin-right: 10px; 
        border: 1px solid #333; 
        background: #000;
    }
    #player-main { flex-grow: 1; overflow: hidden; }
    #player-title { color: #facc15; font-size: 18px; white-space: nowrap; }
    #player-artist { color: #888; font-size: 14px; }
    .controls { margin-top: 5px; display: flex; gap: 5px; }
    .controls button { background: none; border: none; color: #888; cursor: pointer; font-size: 16px; }
    .controls button:hover { color: #fff; }
    input[type=range] { width: 80px; height: 4px; accent-color: #facc15; }

</style>
</head>
<body>

<div class="layout-grid">
    <div class="logo-zone">
        <img src="skull.png" alt="Skull" class="skull-img"> 
    </div>

    <div class="header-bar">
        <div class="header-title">/// SYSTEM TERMINAL</div>
    </div>

    <nav class="nav-column">
        <a href="index.html" class="menu-item">HOME</a>
        <a href="list.html" class="menu-item">LIST</a>
        <a href="chat.html" class="menu-item">CHAT</a>
        <a href="settings.html" class="menu-item">SETTINGS</a>
        <a href="account.html" class="menu-item">ACCOUNT</a>
    </nav>

    <main class="content-area">
        
        <div class="user-status">
            <span id="welcome-message">Loading User...</span>
            <a href="account.html" style="color:#444;">(account)</a>
        </div>

        <div class="splash-container">
            <p id="splash-text">Loading...</p>
        </div>

        <div style="color: #666; font-family: 'Verdana'; font-size: 10px; line-height: 1.6;">
            <p>MAIN FEED ONLINE.</p>
            <p>WAITING FOR INPUT...</p>
        </div>

    </main>
</div>

<audio id="audio-player"></audio>
<div id="music-player-widget">
    <img id="player-cover-art" src="https://placehold.co/64x64/000000/333333?text=...&font=vt323" alt="Cover">
    <div id="player-main">
        <div id="player-info-container">
            <div id="player-title">...</div>
            <div id="player-artist">Loading...</div>
        </div>
        <div class="controls">
            <button id="rewind-btn">&lt;&lt;</button>
            <button id="play-pause-btn">&gt;</button>
            <button id="skip-btn">&gt;&gt;</button>
            <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="1">
        </div>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyAlUyqTb9onQ0PyOxLfZkDddeSnYdB2PlQ",
        authDomain: "ewsitechat.firebaseapp.com",
        databaseURL: "https://ewsitechat-default-rtdb.firebaseio.com",
        projectId: "ewsitechat",
        storageBucket: "ewsitechat.firebasestorage.app",
        messagingSenderId: "282495574514",
        appId: "1:282495574514:web:e2781da630d93fc1ce8b6b"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    const splashEl = document.getElementById('splash-text');
    const randomSplashes = [
        "blacked out like an lv sandal", "son", "bbq chicken alert", 
        "trick or treat.. smell my.. donuts..", "100 perkaholic or pounded by a margwa",
        "considering a page", "long live futtbucker", "six seven", "oh brother..",
        "are you even an ew student?", "i bet ur failing", "get the bawlls!!",
        "six one", "add jiggletip on clash", "new stuff soon",
        "WE yes WE are brainless and failing", "updates soon.. -nl", "no super seniors", "considering a chat board"
    ];

    const announcementRef = ref(db, 'admin/announcement');

    onValue(announcementRef, (snapshot) => {
        const data = snapshot.val();
        if (data && data.text) {
            splashEl.innerText =` ${data.text.toLowerCase()} `;
            splashEl.classList.add('alert-mode');
        } else {
            splashEl.classList.remove('alert-mode');
            if (splashEl.innerText.includes("ALERT") || splashEl.innerText === "Loading...") {
                splashEl.innerText = randomSplashes[Math.floor(Math.random() * randomSplashes.length)];
            }
        }
    });
</script>

<script>
    const baseURL = "https://ewsmusic1.netlify.app/"; 
    const playlist = [
        { title: "Xtal", artist: "Aphex Twin", src: baseURL + "xtal.mp3", cover: baseURL + "aphex.jpg"},
        { title: "I Don't Wanna Be Me", artist: "Type O Negative", src: baseURL + "idontwannabeme.mp3", cover: baseURL + "ton.jpg"},
        { title: "Life Is Killing Me", artist: "Type O Negative", src: baseURL + "lifeiskilling.mp3", cover: baseURL + "ton.jpg"},
        { title: "Exit Music (For a Film)", artist: "Radiohead", src: baseURL + "exitmusic.mp3", cover: baseURL + "radiohead.jpg"},
        { title: "Alternative Outro", artist: "LUCKI", src: baseURL + "alternativeoutro.mp3", cover: baseURL + "lucki.jpg"},
        { title: "Bite My Lip", artist: "fakemink", src: baseURL + "bitemylip.mp3", cover: baseURL + "fakemink.jpg"},
        { title: "Ambilux", artist: "fakemink", src: baseURL + "ambilux.mp3", cover: baseURL + "fakemink3.jpg"},
        { title: "I'm Like Why", artist: "xaviersobased", src: baseURL + "imlikewhy.mp3", cover: baseURL + "xav.jpg"},
        { title: "Love Hate", artist: "xaviersobased", src: baseURL + "lovehate.mp3", cover: baseURL + "xav2.jpg"},
        { title: "Foamposite Interlude", artist: "smokedope2016", src: baseURL + "foamposite.mp3", cover: baseURL + "smokedope2016.jpg"},
        { title: "Abysmal Depths Are Flooded", artist: "Xasthur", src: baseURL + "abysmaldepthsareflooded.mp3", cover: baseURL + "xasthur.jpg"},
        { title: "Diamonds", artist: "Chris Travis", src: baseURL + "diamonds.mp3", cover: baseURL + "christravis.jpg"},
        { title: "Black Magic", artist: "Ethel Wulf", src: baseURL + "blackmagic.mp3", cover: baseURL + "ethel.jpg"},
        { title: "4 Raws", artist: "EsDeeKid", src: baseURL + "4raws.mp3", cover: baseURL + "esdee.jpg"},
        { title: "Fever", artist: "fakemink/buckshot", src: baseURL + "fever.mp3", cover: baseURL + "buckshot.jpg"},
        { title: "Stalks", artist: "Ghost Mountain", src: baseURL + "stalks.mp3", cover: baseURL + "ghostmountain.jpg"},
        { title: "MIA", artist: "feng", src: baseURL + "mia.mp3", cover: baseURL + "feng.jpg"},
        { title: "head in the ceiling fan", artist: "Title Fight", src: baseURL + "titlefight.mp3", cover: baseURL + "title-fih.jpg"},
        { title: "Turn Me Loose", artist: "limpbizkit/eminem", src: baseURL + "turnmeloose.mp3", cover: baseURL + "limp.jpg"},
        { title: "black beetles", artist: "esdeekid", src: baseURL + "bbr.mp3", cover: baseURL + "esdee2.jpg"},
        { title: "apathy", artist: "esdeekid", src: baseURL + "apathy.mp3", cover: baseURL + "esdee3.jpg"},
        { title: "bring it back", artist: "chris travis", src: baseURL + "bib.mp3", cover: baseURL + "chris2.jpg"},
        { title: "die til you live", artist: "fakemink", src: baseURL + "dtyl.mp3", cover: baseURL + "fakemink5.jpg"},
        { title: "worthit", artist: "xaviersobased", src: baseURL + "worthit.mp3", cover: baseURL + "xav.jpg"},
        { title: "in da party", artist: "smokedope2016", src: baseURL + "indaparty.mp3", cover: baseURL + "smokedope4.jpg"},
        { title: "say it aint dro", artist: "smokedope2016", src: baseURL + "dro.mp3", cover: baseURL + "smokedope3.jpg" },
        { title: "blunts on my mind", artist: "ethel wulf", src: baseURL + "bluntsomm.mp3", cover: baseURL + "ethel2.jpg"},
        { title: "luper", artist: "earl sweatshirt", src: baseURL + "luper.mp3", cover: baseURL + "earl.jpg"},
        { title: "frat", artist: "smokedope2016", src: baseURL + "frat.mp3", cover: baseURL + "smokedope2.jpg"},
        { title: "hit the home", artist: "the hand of peace", src: baseURL + "clock.mp3", cover: baseURL + "handofpeace.jpg"},
        { title: "blow me", artist: "fakemink", src: baseURL + "blowme.mp3", cover: baseURL + "fakeminkk.jpg"},
        { title: "minerva", artist: "deftones", src: baseURL + "minerva.mp3", cover: baseURL + "deftones.jpg"},
        { title: "hold on", artist: "limpbizkit", src: baseURL + "holdon.mp3", cover: baseURL + "limpbizkit.jpg"},
        { title: "my way", artist: "limpbizkit", src: baseURL + "myway.mp3", cover: baseURL + "limpbizkit.jpg"},
        { title: "xtal", artist: "aphex twin", src: baseURL + "xtal.mp3", cover: baseURL + "aphextwin.jpg"}
    ];

    document.addEventListener('DOMContentLoaded', () => {
        const playerTitleEl = document.getElementById('player-title');
        const playerArtistEl = document.getElementById('player-artist');
        
        try {
            // UI Update
            const welcomeMessage = document.getElementById('welcome-message');
            function updateUI() {
                let username = localStorage.getItem('username');
                welcomeMessage.textContent = username ? `User: ${username}` : 'User: Guest';
            }
            updateUI();
            
            // Player Logic
            const audioPlayer = document.getElementById('audio-player');
            const playPauseBtn = document.getElementById('play-pause-btn');
            const rewindBtn = document.getElementById('rewind-btn');
            const skipBtn = document.getElementById('skip-btn');
            const playerInfoContainer = document.getElementById('player-info-container');
            const volumeSlider = document.getElementById('volume-slider');
            const playerCoverArt = document.getElementById('player-cover-art');
            const placeholderCover = "https://placehold.co/64x64/000000/333333?text=...&font=vt323";
            
            let currentSongIndex = 0;
            let isPlaying = false;

            const secretSong = {
                title: "hey, big guy said im an easter egg",
                artist: "i heard, if u put /secret at the end of the link",
                src: "clock.mp3",
                cover: "handofpeace.jpg"
            };

            function loadSong(songIndex) {
                const song = (songIndex === -1) ? secretSong : playlist[songIndex];
                if (!song || !song.src) { skipSong(true); return; }
                
                audioPlayer.src = song.src; 
                playerTitleEl.textContent = song.title;
                playerArtistEl.textContent = song.artist;
                playerCoverArt.src = song.cover || placeholderCover;
                playPauseBtn.textContent = '>';
                isPlaying = false;
            }

            function playSong() {
                if (!audioPlayer.src) return;
                audioPlayer.volume = volumeSlider.value; 
                audioPlayer.play().then(() => {
                    playPauseBtn.textContent = '||';
                    isPlaying = true;
                }).catch(e => console.warn(e));
            }

            function pauseSong() {
                audioPlayer.pause();
                playPauseBtn.textContent = '>';
                isPlaying = false;
            }

            function togglePlayPause() { isPlaying ? pauseSong() : playSong(); }
            function skipSong() {
                currentSongIndex = (Math.floor(Math.random() * playlist.length));
                loadSong(currentSongIndex);
                playSong();
            }

            // Save/Load
            window.addEventListener('beforeunload', () => {
                sessionStorage.setItem('musicPlayerState', JSON.stringify({
                    currentSongIndex, currentTime: audioPlayer.currentTime, volume: audioPlayer.volume
                }));
            });
            
            function loadInitialState() {
                const savedState = JSON.parse(sessionStorage.getItem('musicPlayerState'));
                if (savedState) {
                    currentSongIndex = savedState.currentSongIndex;
                    loadSong(currentSongIndex);
                    volumeSlider.value = savedState.volume || 1;
                    audioPlayer.volume = savedState.volume || 1;
                    audioPlayer.currentTime = savedState.currentTime || 0;
                } else {
                    currentSongIndex = Math.floor(Math.random() * playlist.length);
                    loadSong(currentSongIndex);
                }
            }
            
            playPauseBtn.addEventListener('click', togglePlayPause);
            skipBtn.addEventListener('click', () => skipSong());
            rewindBtn.addEventListener('click', () => skipSong()); // Simple random rewind for now
            volumeSlider.addEventListener('input', (e) => audioPlayer.volume = e.target.value);
            audioPlayer.addEventListener('ended', () => skipSong());
            playerCoverArt.addEventListener('error', () => playerCoverArt.src = placeholderCover);

            loadInitialState();
            
        } catch (e) { console.error("Script error:", e); }
    });
</script>
</body>
</html>