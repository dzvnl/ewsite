<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enclave / Starbreeze Style</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Roboto+Condensed:wght@400;700&display=swap" rel="stylesheet">

<style>
    /* --- GLOBAL RESET --- */
    * { box-sizing: border-box; }
    body {
        margin: 0; padding: 0;
        background-color: #000;
        color: #aaa;
        font-family: 'Roboto Condensed', sans-serif; /* Clean industrial font */
        overflow-x: hidden;
    }

    a { text-decoration: none; transition: 0.2s; }

    /* --- LAYOUT GRID --- */
    .interface-container {
        position: relative;
        width: 900px;
        margin: 40px auto;
        min-height: 800px;
        display: grid;
        grid-template-columns: 220px 1fr; /* Left Menu | Right Content */
        grid-template-rows: 140px auto;   /* Top Header | Main Content */
    }

    /* --- THE SKULL & HEADER (Top Left & Top Right) --- */
    .header-branding {
        grid-column: 2 / 3;
        grid-row: 1 / 2;
        background: #111;
        border: 2px solid #4a4a4a;
        border-radius: 20px; /* Rounded industrial edges */
        margin-left: -40px; /* Pull left behind the skull */
        margin-top: 30px;
        height: 80px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(180deg, #2a2a2a 0%, #111 50%, #000 100%);
        box-shadow: inset 0 0 10px #000;
        position: relative;
        z-index: 1;
    }

    .header-text {
        font-family: 'Cinzel', serif;
        font-size: 2.5rem;
        color: #4a4a4a;
        text-shadow: 1px 1px 0 #666;
        letter-spacing: 0.2em;
        text-transform: uppercase;
    }

    /* THE SKULL ZONE (Absolute Positioned over the corner) */
    .skull-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 280px;
        height: 250px;
        z-index: 10;
        pointer-events: none; /* Let clicks pass through if needed */
        
        /* PLACEHOLDER STYLING - REPLACE URL WITH YOUR REAL SKULL IMAGE */
        background-image: url('https://placehold.co/250x250/000000/FFF?text=SKULL+PNG&font=roboto'); 
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
    }

    /* --- THE SPINE MENU (Left Column) --- */
    .spine-menu {
        grid-column: 1 / 2;
        grid-row: 2 / 3;
        padding-top: 50px; /* Space for skull to hang */
        display: flex;
        flex-direction: column;
        align-items: flex-end; /* Align right to touch the content */
        padding-right: 10px;
    }

    /* The "Metal Plate" Links */
    .spine-link {
        display: block;
        width: 140px;
        height: 35px;
        margin-bottom: 8px;
        background: linear-gradient(90deg, #111, #333, #111);
        border: 1px solid #555;
        border-right: none; /* Connects to nothing on right */
        color: #888;
        font-family: 'Cinzel', serif;
        font-size: 14px;
        font-weight: bold;
        text-align: center;
        line-height: 33px;
        text-transform: uppercase;
        position: relative;
        clip-path: polygon(10% 0, 100% 0, 100% 100%, 10% 100%, 0% 50%); /* Pointed left edge */
        cursor: pointer;
    }
    
    /* Wires/Connectors decoration */
    .spine-link::before {
        content: '';
        position: absolute;
        right: -10px;
        top: 50%;
        width: 10px;
        height: 2px;
        background: #555;
    }

    .spine-link:hover {
        background: #222;
        color: #d2691e; /* Rusty Orange */
        text-shadow: 0 0 5px #d2691e;
        width: 150px; /* Pop out effect */
    }

    /* --- CONTENT FRAME (Right Column) --- */
    .main-display {
        grid-column: 2 / 3;
        grid-row: 2 / 3;
        border-top: 4px solid #333;
        border-bottom: 4px solid #333;
        background: rgba(0,0,0,0.5);
        padding: 0 40px;
        position: relative;
    }

    /* The "Pillars" on the sides of the content */
    .main-display::before, .main-display::after {
        content: '';
        position: absolute;
        top: 0; bottom: 0;
        width: 4px;
        background: #333;
        background-image: repeating-linear-gradient(0deg, #333 0, #333 5px, #000 5px, #000 10px);
    }
    .main-display::before { left: 0; }
    .main-display::after { right: 0; }

    /* --- TEXT STYLING (Orange Theme) --- */
    .news-block {
        margin-bottom: 30px;
        border-bottom: 1px dashed #333;
        padding-bottom: 20px;
    }
    .news-title {
        color: #e67e22; /* Matches the Orange in screenshot */
        font-size: 1.2rem;
        font-weight: bold;
        margin-bottom: 5px;
        font-family: 'Arial', sans-serif;
    }
    .news-date {
        color: #666;
        font-size: 0.8rem;
        margin-bottom: 10px;
    }
    .news-content {
        color: #ccc;
        font-size: 0.95rem;
        line-height: 1.5;
    }
    .news-link {
        color: #e67e22;
        text-decoration: underline;
    }

    /* SPLASH / ALERT STYLES */
    .alert-mode {
        color: #ef4444 !important;
        text-shadow: 0 0 8px #ef4444;
        animation: pulse 2s infinite;
    }
    @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.7; } 100% { opacity: 1; } }

    /* --- PLAYER CSS (Your original retro player, adjusted slightly) --- */
    #music-player-widget {
        position: fixed;
        bottom: 1rem; right: 1rem; z-index: 100;
        width: 320px; 
        background-color: #000;
        border: 2px solid #555;
        padding: 10px;
        display: flex; align-items: center;
        font-family: 'VT323', monospace; /* Keep the pixel font for the tech feel */
    }
    #player-cover-art { width: 50px; height: 50px; margin-right: 10px; border: 1px solid #333; }
    #player-main { flex-grow: 1; overflow: hidden; }
    #player-title { color: #e67e22; font-size: 1.1rem; white-space: nowrap; }
    #player-artist { color: #888; font-size: 0.9rem; }
    .player-controls-row button { background: none; border: none; color: #e67e22; cursor: pointer; font-size: 1.2rem; margin-right: 5px; }
    #volume-slider { width: 80px; height: 5px; accent-color: #e67e22; }

</style>
</head>
<body>

<div class="interface-container">

    <div class="skull-overlay" title="Place your skull.png here"></div>

    <div class="header-branding">
        <div class="header-text">STARBREEZE STUDIOS</div>
    </div>

    <nav class="spine-menu">
        <a href="index.html" class="spine-link">NEWS</a>
        <a href="list.html" class="spine-link">PROJECTS</a>
        <a href="chat.html" class="spine-link">COMPANY</a>
        <a href="#" class="spine-link">JOBS</a>
        <a href="#" class="spine-link">HISTORY</a>
        <a href="settings.html" class="spine-link">DOWNLOADS</a>
        <a href="account.html" class="spine-link">LINKS</a>
    </nav>

    <main class="main-display">
        
        <div class="news-block" style="margin-top: 20px;">
            <div class="news-title">System Announcement</div>
            <div class="news-date">LIVE FEED</div>
            <div class="news-content">
                <p id="splash-text" style="font-size: 1.2em;">Connecting to server...</p>
                <br>
                <p id="welcome-message" style="color:#666; font-size: 0.8em;">Identifying user...</p>
            </div>
        </div>

        <div class="news-block">
            <div class="news-title">Starbreeze unveils Enclave</div>
            <div class="news-date">20 March 2000</div>
            <div class="news-content">
                We're proud to announce our new game, Enclave, which is scheduled for release in mid-2001. Enclave is a first-person shooter set in an evolved fantasy world. Visit the <a href="#" class="news-link">Enclave site</a> for more details.
            </div>
        </div>

        <div class="news-block">
            <div class="news-title">Sorcery terminated</div>
            <div class="news-date">19 January 2000</div>
            <div class="news-content">
                We regret to inform everyone waiting for Sorcery that the project has been terminated. Read more about it <a href="#" class="news-link">here</a>.
            </div>
        </div>

        <div style="text-align: right;">
            <a href="#" class="news-link" style="font-size: 0.8rem;">[ Archived News ]</a>
        </div>

    </main>

</div>

<audio id="audio-player"></audio>
<div id="music-player-widget">
    <img id="player-cover-art" src="https://placehold.co/64x64/000000/333333?text=...&font=vt323" alt="Album Cover">
    <div id="player-main">
        <div id="player-info-container" title="...">
            <div id="player-title">...</div>
            <div id="player-artist">Loading...</div>
        </div>
        <div class="player-controls-row">
            <button id="rewind-btn" title="Previous">&lt;&lt;</button>
            <button id="play-pause-btn" title="Play/Pause">&gt;</button>
            <button id="skip-btn" title="Next (Shuffle)">&gt;&gt;</button>
            <input type="range" id="volume-slider" min="0" max="1" step="0.01" value="1" title="Volume">
        </div>
    </div>
</div>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

    const firebaseConfig = {
        apiKey: "AIzaSyAlUyqTb9onQ0PyOxLfZkDddeSnYdB2PlQ",
        authDomain: "ewsitechat.firebaseapp.com",
        databaseURL: "https://ewsitechat-default-rtdb.firebaseio.com",
        projectId: "ewsitechat",
        storageBucket: "ewsitechat.firebasestorage.app",
        messagingSenderId: "282495574514",
        appId: "1:282495574514:web:e2781da630d93fc1ce8b6b"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // --- SPLASH LOGIC ---
    const splashEl = document.getElementById('splash-text');
    
    // Fallback Sprashes
    const randomSplashes = [
        "blacked out like an lv sandal", "son", "bbq chicken alert", 
        "trick or treat.. smell my.. donuts..", "100 perkaholic or pounded by a margwa",
        "considering a page", "long live futtbucker", "six seven", "oh brother..",
        "are you even an ew student?", "i bet ur failing", "get the bawlls!!",
        "six one", "add jiggletip on clash", "new stuff soon",
        "WE yes WE are brainless and failing", "updates soon.. -nl", "no super seniors", "considering a chat board"
    ];

    // Listen to Admin Announcement
    const announcementRef = ref(db, 'admin/announcement');

    onValue(announcementRef, (snapshot) => {
        const data = snapshot.val();
        if (data && data.text) {
            // ADMIN MODE
            splashEl.innerText =` ${data.text.toLowerCase()} `;
            splashEl.classList.add('alert-mode');
        } else {
            // NORMAL MODE
            splashEl.classList.remove('alert-mode');
            if (splashEl.innerText.includes("ALERT") || splashEl.innerText === "Connecting to server...") {
                splashEl.innerText = randomSplashes[Math.floor(Math.random() * randomSplashes.length)];
            }
        }
    });
</script>

<script>
    const baseURL = "https://ewsmusic1.netlify.app/"; 
    const playlist = [
        { title: "Xtal", artist: "Aphex Twin", src: baseURL + "xtal.mp3", cover: baseURL + "aphex.jpg"},
        { title: "I Don't Wanna Be Me", artist: "Type O Negative", src: baseURL + "idontwannabeme.mp3", cover: baseURL + "ton.jpg"},
        { title: "Life Is Killing Me", artist: "Type O Negative", src: baseURL + "lifeiskilling.mp3", cover: baseURL + "ton.jpg"},
        { title: "Exit Music (For a Film)", artist: "Radiohead", src: baseURL + "exitmusic.mp3", cover: baseURL + "radiohead.jpg"},
        { title: "Alternative Outro", artist: "LUCKI", src: baseURL + "alternativeoutro.mp3", cover: baseURL + "lucki.jpg"},
        { title: "Bite My Lip", artist: "fakemink", src: baseURL + "bitemylip.mp3", cover: baseURL + "fakemink.jpg"},
        { title: "Ambilux", artist: "fakemink", src: baseURL + "ambilux.mp3", cover: baseURL + "fakemink3.jpg"},
        { title: "I'm Like Why", artist: "xaviersobased", src: baseURL + "imlikewhy.mp3", cover: baseURL + "xav.jpg"},
        { title: "Love Hate", artist: "xaviersobased", src: baseURL + "lovehate.mp3", cover: baseURL + "xav2.jpg"},
        { title: "Foamposite Interlude", artist: "smokedope2016", src: baseURL + "foamposite.mp3", cover: baseURL + "smokedope2016.jpg"},
        { title: "Abysmal Depths Are Flooded", artist: "Xasthur", src: baseURL + "abysmaldepthsareflooded.mp3", cover: baseURL + "xasthur.jpg"},
        { title: "Diamonds", artist: "Chris Travis", src: baseURL + "diamonds.mp3", cover: baseURL + "christravis.jpg"},
        { title: "Black Magic", artist: "Ethel Wulf", src: baseURL + "blackmagic.mp3", cover: baseURL + "ethel.jpg"},
        { title: "4 Raws", artist: "EsDeeKid", src: baseURL + "4raws.mp3", cover: baseURL + "esdee.jpg"},
        { title: "Fever", artist: "fakemink/buckshot", src: baseURL + "fever.mp3", cover: baseURL + "buckshot.jpg"},
        { title: "Stalks", artist: "Ghost Mountain", src: baseURL + "stalks.mp3", cover: baseURL + "ghostmountain.jpg"},
        { title: "MIA", artist: "feng", src: baseURL + "mia.mp3", cover: baseURL + "feng.jpg"},
        { title: "head in the ceiling fan", artist: "Title Fight", src: baseURL + "titlefight.mp3", cover: baseURL + "title-fih.jpg"},
        { title: "Turn Me Loose", artist: "limpbizkit/eminem", src: baseURL + "turnmeloose.mp3", cover: baseURL + "limp.jpg"},
        { title: "black beetles", artist: "esdeekid", src: baseURL + "bbr.mp3", cover: baseURL + "esdee2.jpg"},
        { title: "apathy", artist: "esdeekid", src: baseURL + "apathy.mp3", cover: baseURL + "esdee3.jpg"},
        { title: "bring it back", artist: "chris travis", src: baseURL + "bib.mp3", cover: baseURL + "chris2.jpg"},
        { title: "die til you live", artist: "fakemink", src: baseURL + "dtyl.mp3", cover: baseURL + "fakemink5.jpg"},
        { title: "worthit", artist: "xaviersobased", src: baseURL + "worthit.mp3", cover: baseURL + "xav.jpg"},
        { title: "in da party", artist: "smokedope2016", src: baseURL + "indaparty.mp3", cover: baseURL + "smokedope4.jpg"},
        { title: "say it aint dro", artist: "smokedope2016", src: baseURL + "dro.mp3", cover: baseURL + "smokedope3.jpg" },
        { title: "blunts on my mind", artist: "ethel wulf", src: baseURL + "bluntsomm.mp3", cover: baseURL + "ethel2.jpg"},
        { title: "luper", artist: "earl sweatshirt", src: baseURL + "luper.mp3", cover: baseURL + "earl.jpg"},
        { title: "frat", artist: "smokedope2016", src: baseURL + "frat.mp3", cover: baseURL + "smokedope2.jpg"},
        { title: "hit the home", artist: "the hand of peace", src: baseURL + "clock.mp3", cover: baseURL + "handofpeace.jpg"},
        { title: "blow me", artist: "fakemink", src: baseURL + "blowme.mp3", cover: baseURL + "fakeminkk.jpg"},
        { title: "minerva", artist: "deftones", src: baseURL + "minerva.mp3", cover: baseURL + "deftones.jpg"},
        { title: "hold on", artist: "limpbizkit", src: baseURL + "holdon.mp3", cover: baseURL + "limpbizkit.jpg"},
        { title: "my way", artist: "limpbizkit", src: baseURL + "myway.mp3", cover: baseURL + "limpbizkit.jpg"},
        { title: "xtal", artist: "aphex twin", src: baseURL + "xtal.mp3", cover: baseURL + "aphextwin.jpg"}
    ];

    document.addEventListener('DOMContentLoaded', () => {
        const playerTitleEl = document.getElementById('player-title');
        const playerArtistEl = document.getElementById('player-artist');
        
        try {
            // --- USER UI ---
            const welcomeMessage = document.getElementById('welcome-message');
            
            function updateUI() {
                let username = localStorage.getItem('username');
                if (username) {
                    welcomeMessage.textContent = `User: ${username}`;
                } else {
                    welcomeMessage.textContent = 'User: Guest';
                }
            }
            updateUI();
            
            // --- MUSIC PLAYER LOGIC ---
            const audioPlayer = document.getElementById('audio-player');
            const playPauseBtn = document.getElementById('play-pause-btn');
            const rewindBtn = document.getElementById('rewind-btn');
            const skipBtn = document.getElementById('skip-btn');
            const playerInfoContainer = document.getElementById('player-info-container');
            const volumeSlider = document.getElementById('volume-slider');
            const playerCoverArt = document.getElementById('player-cover-art');
            const placeholderCover = "https://placehold.co/64x64/000000/333333?text=...&font=vt323";
            
            let currentSongIndex = 0;
            let isPlaying = false;

            const secretSong = {
                title: "hey, big guy said im an easter egg",
                artist: "i heard, if u put /secret at the end of the link",
                src: "clock.mp3",
                cover: "handofpeace.jpg"
            };

            function loadSong(songIndex) {
                const song = (songIndex === -1) ? secretSong : playlist[songIndex];
                if (!song || !song.src || !song.cover) {
                    skipSong(true); 
                    return;
                }
                
                audioPlayer.src = song.src; 
                playerInfoContainer.title = `${song.title} - ${song.artist}`; 
                playerTitleEl.textContent = song.title;
                playerArtistEl.textContent = song.artist;
                playerCoverArt.src = song.cover;
                playPauseBtn.textContent = '>';
                isPlaying = false;
            }

            function playSong() {
                if (!audioPlayer.src) { return; }
                audioPlayer.volume = volumeSlider.value; 
                
                const playPromise = audioPlayer.play();
                if (playPromise !== undefined) {
                    playPromise.then(() => {
                        playPauseBtn.textContent = '||';
                        isPlaying = true;
                    }).catch(error => {
                        console.warn("Auto-play blocked", error);
                    });
                }
            }

            function pauseSong() {
                audioPlayer.pause();
                playPauseBtn.textContent = '>';
                isPlaying = false;
            }

            function togglePlayPause() {
                if (isPlaying) { pauseSong(); } else { playSong(); }
            }

            function skipSong(skipOnly = false) {
                let nextSongIndex = Math.floor(Math.random() * playlist.length);
                if (nextSongIndex === currentSongIndex && playlist.length > 1) {
                    nextSongIndex = (nextSongIndex + 1) % playlist.length; 
                }
                currentSongIndex = nextSongIndex;
                loadSong(currentSongIndex);
                if (audioPlayer.src && !skipOnly) { playSong(); }
            }

            function rewindSong() {
                currentSongIndex = (currentSongIndex - 1 + playlist.length) % playlist.length;
                loadSong(currentSongIndex);
                if (audioPlayer.src) { playSong(); }
            }
            
            // --- STORAGE SAVE/LOAD ---
            window.addEventListener('beforeunload', () => {
                if (audioPlayer.currentTime > 0) {
                    const musicState = {
                        currentSongIndex: currentSongIndex,
                        currentTime: audioPlayer.currentTime,
                        volume: audioPlayer.volume,
                        isPlaying: isPlaying
                    };
                    sessionStorage.setItem('musicPlayerState', JSON.stringify(musicState));
                }
            });
            
            function loadInitialState() {
                const savedStateJSON = sessionStorage.getItem('musicPlayerState');
                let savedState = null;
                if (savedStateJSON) {
                    try { savedState = JSON.parse(savedStateJSON); } 
                    catch (e) { sessionStorage.removeItem('musicPlayerState'); }
                }

                if (savedState) {
                    currentSongIndex = savedState.currentSongIndex;
                    loadSong(currentSongIndex);
                    volumeSlider.value = savedState.volume || 1;
                    audioPlayer.volume = savedState.volume || 1;
                    audioPlayer.addEventListener('loadedmetadata', () => {
                        audioPlayer.currentTime = savedState.currentTime || 0;
                        if (savedState.isPlaying) { playSong(); }
                    }, { once: true }); 
                } else {
                    const rareSongChance = Math.floor(Math.random() * 50);
                    currentSongIndex = (rareSongChance === 0) ? -1 : Math.floor(Math.random() * playlist.length);
                    loadSong(currentSongIndex);
                    audioPlayer.volume = volumeSlider.value;
                }
            }
            
            playPauseBtn.addEventListener('click', togglePlayPause);
            skipBtn.addEventListener('click', () => skipSong(false));
            rewindBtn.addEventListener('click', rewindSong);
            volumeSlider.addEventListener('input', (e) => { audioPlayer.volume = e.target.value; });
            audioPlayer.addEventListener('ended', () => skipSong(false));
            playerCoverArt.addEventListener('error', () => { playerCoverArt.src = placeholderCover; });

            loadInitialState();
            
        } catch (e) {
            console.error("Script error:", e);
        }
    });
</script>
</body>
</html>